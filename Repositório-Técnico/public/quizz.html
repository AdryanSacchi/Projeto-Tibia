<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dungeon</title>
    <link rel="stylesheet" href="css/quizz.css">
</head>

<body onload="iniciar()">
    <div class="pontuacaoJust" id="pontuacaoEJogo">

        <div id="menuInicial" class="flex-colunar" style="gap: 10px; align-items: center;">
            <label for="inputNick" style="color: white; font-weight: bold;">Digite seu Nick:</label>
            <input type="text" id="inputNick" placeholder="Ex: O Mago Claudio"
                style="padding: 8px; border-radius: 5px; border: none;">



            <button id="btnIniciarQuiz" onclick="iniciarJogo()">Come√ßar a Jornada</button>
        </div>
        <button id="botaoVoltarNick" onclick="voltar()">Voltar</button>

        <div id="pontuacao" class="flex-colunar" style="display: none;">
            <div id="pontuacaoDuranteJogo" class="icons-quiz">
                <div id="painelAtributos" class="padding-8 font-size: 10px"
                    style="color: white; font-size: 14px; margin-top: 10px;">

                    <div
                        style="margin-bottom: 5px; border-bottom: 1px solid gray; padding-bottom: 5px; min-width: 10px;">
                        Heroi: <span id="spanNomeJogador" class="text-bold" style="color: gold;">---</span>
                    </div>

                    <div>Classe: <span id="spanClasse" class="text-bold">Nenhuma</span></div>
                    <div style="font-size: 25px;" id="atributos">
                        <span>üí™üèª For: <span id="attrForca">0</span></span>
                        <span>üëü Agi: <span id="attrAgilidade">0</span></span>
                        <span>üß† Int: <span id="attrInteligencia">0</span></span>
                        <span>üçÄ Sor: <span id="attrSorte">0</span></span>
                        <span>üõ°Ô∏è Res: <span id="attrResistencia">0</span></span>
                    </div>
                    <div id="msgLevelUp" style="color: yellow; font-weight: bold; height: 20px;"></div>
                </div>
                <img src="assets/icon/cora√ß√£ov1.png" alt="Icon Cora√ß√£o" class="coracao"><span
                    id="spanVidaAtual">100</span>
                <img src="assets/icon/andar-vermelho.png" alt="Icon Andar" class="andar"><span>Piso<span
                        id="spanPisoAtual">1</span></span>
            </div>
        </div>

        <div id="jogo" class=" flex-colunar border-secondary" style="display: none;">

            <div id="infoQuestao" class="padding-8">
                <span>Piso atual: <span id="spanNumeroDaQuestaoAtual"></span> de <span id="qtdQuestoes"></span>
                    pisos.</span>
            </div>

            <div id="perguntaDaQuestaoAtual" class="padding-8">
                <span id="spanQuestaoExibida" class="text-bold"></span>
            </div>

            <div id="infoAlternativas" class="padding-8">
                <span><em>Escolha uma op√ß√£o dentre as abaixo:</em></span>
            </div>

            <div id="opcoes" class="flex-colunar padding-8">
                <span>
                    <input type="radio" id="primeiraOpcao" name="option" class="radio" value="alternativaA" />
                    <label for="primeiraOpcao" class="option" id="labelOpcaoUm"></label>
                </span>
                <span>
                    <input type="radio" id="segundaOpcao" name="option" class="radio" value="alternativaB" />
                    <label for="segundaOpcao" class="option" id="labelOpcaoDois"></label>
                </span>
                <span>
                    <input type="radio" id="terceiraOpcao" name="option" class="radio" value="alternativaC" />
                    <label for="terceiraOpcao" class="option" id="labelOpcaoTres"></label>
                </span>
                <span>
                    <input type="radio" id="quartaOpcao" name="option" class="radio" value="alternativaD" />
                    <label for="quartaOpcao" class="option" id="labelOpcaoQuatro"></label>
                </span>
            </div>

            <div id="botoes" class="flex-colunar padding-8">
                <button onclick="submeter()" id="btnSubmeter">Ja me decidi!</button>
                <button onclick="proximoPiso()" id="btnProx" disabled>Avan√ßar para o pr√≥ximo andar</button>
                <button onclick="tentarNovamente()" id="btnTentarNovamente" disabled>RESULTADOS</button>
                <button id="botaoVoltarQuiz" onclick="voltar()">Fugir</button>
            </div>

        </div>

    </div>
</body>

</html>
<script>
    function voltar() {
        window.location.href = "index.html";
    }

    const QUESTOES = [
        {
            pergunta: "Como um primeiro passo, voc√™ deve escolher sua classe:",
            alternativaA: "Quero ser um Paladino!",
            alternativaB: "Quero ser um Guerreiro!",
            alternativaC: "Quero ser um Mago!",
            alternativaD: "Quero ser um Monge!",
            alternativaCorreta: "todas"
        },

        {
            pergunta: "Voc√™ acabou de entrar em uma Masmorra, logo a sua frente voc√™ encntra algumas op√ß√µes para prosseguir:",
            alternativaA: "ir pelo caminho F√°cil (hehe)",
            alternativaB: "ir pelo Caminho totalmente escuro",
            alternativaC: "ir pela ponte quebrada",
            alternativaD: "aguardar (?)",
            alternativaCorreta: "alternativaC"
        },
        {
            pergunta: "Ok, parece que subimos um andar.. Voc√™ escuta um grito vindo do fundo do corredor, sem ter muito tempo para pensar, precisa tomar uma decis√£o:",
            alternativaA: "Correr em dire√ß√£o ao grito",
            alternativaB: "Se esconder",
            alternativaC: "Virar a direita onde h√° algumas tochas",
            alternativaD: "Pegar a tocha que est√° na parede e aguardar",
            alternativaCorreta: "alternativaB"
        },
        {
            pergunta: "Parece que voc√™ sobreviveu a mais um andar, ser√° que agora √© um andar de sorte para voc√™ ? Na sua frente voc√™ ve 3 ba√∫s, o mais a esquerda esta coberto de lodo, o do meio tem chamas saindo em volta dele e o da direita parece um ba√∫ normal,gostaria de abrir um deles?",
            alternativaA: "Sim, quero abrir o ba√∫ da esquerda.",
            alternativaB: "Sim, quero abrir o ba√∫ do meio.",
            alternativaC: "Sim, quero abrir o ba√∫ da direita.",
            alternativaD: "Eu sou suficiente com meus equipamentos!",
            alternativaCorreta: "alternativaD"
        },
        {
            pergunta: "Curioso.. voc√™ est√° indo bem demais, √© sua primeira vez aqui?",
            alternativaA: "Sim",
            alternativaB: "N√£o",
            alternativaC: "QUEM TA PERGUNTANDO ISSO?!!??",
            alternativaD: "(sil√™ncio)",
            alternativaCorreta: "alternativaD"
        },
        {
            pergunta: "Nessa pr√≥xima etapa voc√™ deu de cara com 3 monstros, um esquilo com olhos vermelhos, zumbi com um taco na m√£o e um sapo grande com uma espada nas costas, o que deseja fazer?",
            alternativaA: "Quero correr, chega disso!",
            alternativaB: "Vou em dire√ß√£o ao Sapo",
            alternativaC: "Tento enfrentar o esquilo",
            alternativaD: "Vou roubar o taco do zumbi",
            alternativaCorreta: "alternativaB"
        },
        {
            pergunta: "Parece que temos um sortudo por aqui, mas isso vai durar at√© quando ? Selecione um bot√£o, AZUL, VERDE OU VERMELHO?",
            alternativaA: "AZUL",
            alternativaB: "VERDE",
            alternativaC: "VERMELHO",
            alternativaD: "TODOS",
            alternativaCorreta: "alternativaB"
        },
        {
            pergunta: "Ja deve estar cansado de tudo isso, por que n√£o se deita ? Nesse piso temos uma cama perto de uma fogueira",
            alternativaA: "Vou me deitar",
            alternativaB: "Vou sentar ao lado da fogueira",
            alternativaC: "Quero checar em baixo da cama",
            alternativaD: "Recuso a oferta e sigo meu caminho",
            alternativaCorreta: "alternativaD"
        },
        {
            pergunta: "Parab√©ns por ter chego at√© aqui, nosso soberano Azariel te da as boas-vindas. (Voc√™ ve uma figura monstruosa bem a sua frente lhe dando passagem para um ba√∫ final)",
            alternativaA: "Pulo a primeira janela que encontro",
            alternativaB: "Caminho em dire√ß√£o ao ba√∫",
            alternativaC: "Chamo Azariel pra a briga (s√©rio isso?)",
            alternativaD: "Fico encarando Azariel",
            alternativaCorreta: "alternativaA"
        },
    ];

    let jogador = {
        nome: "",
        classe: "Nenhuma",
        atributos: {
            forca: 0,
            agilidade: 0,
            inteligencia: 0,
            sorte: 0,
            resistencia: 0
        }
    };

    let questaoAtual = 0;
    let vida = 100;
    let piso = 1;
    const DANO = (Math.random() * 15 + 15).toFixed();

    function iniciar() {
        document.getElementById('pontuacao').style.display = "none";
        document.getElementById('jogo').style.display = "none";
    }

    function iniciarJogo() {
        var nickDigitado = document.getElementById('inputNick').value;

        if (nickDigitado == "") {
            alert("Por favor, digite um Nick para come√ßar a jornada!");
            return;
        } else {
            document.getElementById('botaoVoltarNick').style.display = "none";
        }

        jogador.nome = nickDigitado;
        atualizarPainelAtributos();
        document.getElementById('menuInicial').style.display = "none";
        document.getElementById('pontuacao').style.display = "flex";
        document.getElementById('jogo').style.display = "flex";
        document.getElementById('qtdQuestoes').innerHTML = QUESTOES.length;
        document.getElementById('spanVidaAtual').innerHTML = vida;
        document.getElementById('spanPisoAtual').innerHTML = piso;

        carregarQuestao(0);
    }

    function carregarQuestao(i) {
        questaoAtual = i;
        const q = QUESTOES[i];

        habilitarOpcoes(true);

        document.getElementById('spanNumeroDaQuestaoAtual').innerHTML = piso;
        document.getElementById('spanQuestaoExibida').innerHTML = q.pergunta;

        document.getElementById('labelOpcaoUm').innerHTML = q.alternativaA;
        document.getElementById('labelOpcaoDois').innerHTML = q.alternativaB;
        document.getElementById('labelOpcaoTres').innerHTML = q.alternativaC;
        document.getElementById('labelOpcaoQuatro').innerHTML = q.alternativaD;
    }

    function submeter() {
        const opcoes = document.getElementsByName("option");
        let selecionado = null;

        for (let i = 0; i < opcoes.length && selecionado === null; i++) {
            if (opcoes[i].checked) {
                selecionado = opcoes[i];
            }
        }

        if (selecionado === null) {
            alert("Escolha uma op√ß√£o antes de continuar!");
        } else {
            document.getElementById('btnSubmeter').disabled = true;
            document.getElementById('btnProx').disabled = false;
            habilitarOpcoes(false);

            verificarResposta(selecionado.value);
        }

    }

    function habilitarOpcoes(resposta) {
        document.getElementById('primeiraOpcao').disabled = !resposta;
        document.getElementById('segundaOpcao').disabled = !resposta;
        document.getElementById('terceiraOpcao').disabled = !resposta;
        document.getElementById('quartaOpcao').disabled = !resposta;
    }

    function proximoPiso() {
        document.getElementById('btnProx').disabled = true;
        document.getElementById('btnSubmeter').disabled = false;

        limparSelecao();
        limparCores();

        piso++;
        document.getElementById('spanPisoAtual').innerHTML = piso;
        questaoAtual++;

        if (questaoAtual < QUESTOES.length) {
            carregarQuestao(questaoAtual);
        } else {
            finalizar(false);
        }
    }

    function tentarNovamente() {
        window.location.href = "dashboard.html";
    }

    function verificarResposta(resposta) {
        const q = QUESTOES[questaoAtual];
        const correta = q.alternativaCorreta;
        const inputSelecionado = document.querySelector('input[value="' + resposta + '"]');
        const labelSelecionado = inputSelecionado.labels[0];

        if (questaoAtual === 0) {
            let textoClasse = labelSelecionado.innerText;
            jogador.classe = textoClasse.replace("Quero ser um ", "").replace("!", "");
            atualizarPainelAtributos();
        }
        if (correta === "todas" || resposta === correta) {
            labelSelecionado.classList.add("text-success-with-bg");
            darRecompensaDeAtributo();
        } else {
            labelSelecionado.classList.add("text-danger-with-bg");
            const inputCorreto = document.querySelector('input[value="' + correta + '"]');
            if (inputCorreto) {
                inputCorreto.labels[0].classList.add("text-success-with-bg");
            }
            darRecompensaDeAtributo();

            vida = vida - DANO;
            if (vida < 0) {
                vida = 0;
            }
            document.getElementById('spanVidaAtual').innerHTML = vida;
        }

        if (vida <= 0) {
            finalizar(true);
        }
    }

    function finalizar(morreu) {
        if (morreu) {
            alert("GAME OVER! O her√≥i " + jogador.nome + " caiu no Piso " + piso);
        } else {
            alert("Parab√©ns! " + jogador.nome + " completou todos os pisos! (talvez n√£o inteiro)");
        }

        habilitarOpcoes(false);
        document.getElementById('btnSubmeter').disabled = true;
        document.getElementById('btnProx').disabled = true;
        document.getElementById('btnTentarNovamente').disabled = false;

        document.getElementById('jogo').classList.add("text-new-gray");
    }

    function limparCores() {
        const opcoes = document.getElementsByName("option");

        for (let i = 0; i < opcoes.length; i++) {
            const label = opcoes[i].labels[0];
            label.classList.remove("text-danger-with-bg");
            label.classList.remove("text-success-with-bg");
        }
    }

    function limparSelecao() {
        const opcoes = document.getElementsByName("option");

        for (let i = 0; i < opcoes.length; i++) {
            opcoes[i].checked = false;
        }
    }
    function darRecompensaDeAtributo() {
        const listaAtributos = ['forca', 'agilidade', 'inteligencia', 'sorte', 'resistencia'];
        const indiceSorteado = Math.floor(Math.random() * listaAtributos.length);
        const atributoEscolhido = listaAtributos[indiceSorteado];
        const pontosGanhos = Math.floor(Math.random() * 3) + 1;
        jogador.atributos[atributoEscolhido] += pontosGanhos;
        atualizarPainelAtributos();
        setTimeout(() => {
            document.getElementById('msgLevelUp').innerHTML = "";
        }, 200);
    }

    function atualizarPainelAtributos() {
        document.getElementById('spanNomeJogador').innerHTML = jogador.nome;
        document.getElementById('spanClasse').innerHTML = jogador.classe;
        document.getElementById('attrForca').innerHTML = jogador.atributos.forca;
        document.getElementById('attrAgilidade').innerHTML = jogador.atributos.agilidade;
        document.getElementById('attrInteligencia').innerHTML = jogador.atributos.inteligencia;
        document.getElementById('attrSorte').innerHTML = jogador.atributos.sorte;
        document.getElementById('attrResistencia').innerHTML = jogador.atributos.resistencia;
    }

</script>